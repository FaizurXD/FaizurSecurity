{
  "version": 3,
  "sources": ["../../events/channelcreations.ts"],
  "sourcesContent": ["import type { GuildBasedChannel, TextChannel } from \"discord.js\"\nimport { Events, AuditLogEvent, PermissionFlagsBits } from \"discord.js\";\nimport { logBuilder } from \"../utils.js\";\nimport prisma from \"../database.js\";\n\nexport default class ChannelCreations {\n\tname = Events.ChannelCreate\n\n\tstatic times = 0\n\tstatic channels: string[] = []\n\n\tasync run(channel: GuildBasedChannel) {\n\t\tconst guild = await prisma.guild.findUnique({\n\t\t\twhere: { guild:\tchannel.guild.id },\n\t\t\tselect: { antiRaid: true }\n\t\t})\n\n\t\tif (!guild?.antiRaid) return;\n\t\tif (!channel.guild) return false;\n\t\t\n\t\tChannelCreations.channels.push(channel.id)\n\t\tChannelCreations.times++\n\t\t\n\t\tif (ChannelCreations.times >= 5) {\n\t\t\tconst auditLogFetch = await channel.guild.fetchAuditLogs({ limit: 1, type: AuditLogEvent.ChannelCreate });\n\t\t\tconst log = auditLogFetch.entries.first()\n\t\t\tif (channel.client.user?.id === log?.executor?.id) return\n\t\t\tconst member = await channel.guild.members.fetch(log?.executor?.id!)\n\t\t\tchannel.guild.roles.cache\n\t\t\t\t.filter(r => r.permissions.has(PermissionFlagsBits.Administrator))\n\t\t\t\t.forEach(async r => await member.roles.remove(r, \"Creating too many channels\").catch(async () => await r.setPermissions([], \"Creating too many channels\").catch(() => { })))\n\t\t\tChannelCreations.channels.forEach(async c => await channel.guild.channels.cache.get(c)?.delete().catch(() => { }))\n\n\t\t\tconst guild = await prisma.guild.findUnique({\n\t\t\t\twhere: { guild: channel.guild.id },\n\t\t\t\tselect: { logs: true }\n\t\t\t})\n\t\n\t\t\tconst logs = channel.guild?.channels.cache.get(guild?.logs!) as TextChannel\n\t\t\tawait logs?.send(\n\t\t\t\tlogBuilder({\n\t\t\t\t\tmember,\n\t\t\t\t\tcontent: `${member.user} has been demoted for creating too many channels.`,\n\t\t\t\t\treason: `Too many channels created.`,\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tChannelCreations.times = 0\n\t\t\tChannelCreations.channels = []\n\t\t}, 8000)\n\t}\n}"],
  "mappings": "AACA,SAAS,QAAQ,eAAe,2BAA2B;AAC3D,SAAS,kBAAkB;AAC3B,OAAO,YAAY;AAEnB,MAAqB,oBAArB,MAAsC;AAAA,EAAtC;AACC,gBAAO,OAAO;AAAA;AAAA,EAKd,MAAM,IAAI,SAA4B;AAXvC;AAYE,UAAM,QAAQ,MAAM,OAAO,MAAM,WAAW;AAAA,MAC3C,OAAO,EAAE,OAAO,QAAQ,MAAM,GAAG;AAAA,MACjC,QAAQ,EAAE,UAAU,KAAK;AAAA,IAC1B,CAAC;AAED,QAAI,EAAC,+BAAO;AAAU;AACtB,QAAI,CAAC,QAAQ;AAAO,aAAO;AAE3B,sBAAiB,SAAS,KAAK,QAAQ,EAAE;AACzC,sBAAiB;AAEjB,QAAI,kBAAiB,SAAS,GAAG;AAChC,YAAM,gBAAgB,MAAM,QAAQ,MAAM,eAAe,EAAE,OAAO,GAAG,MAAM,cAAc,cAAc,CAAC;AACxG,YAAM,MAAM,cAAc,QAAQ,MAAM;AACxC,YAAI,aAAQ,OAAO,SAAf,mBAAqB,UAAO,gCAAK,aAAL,mBAAe;AAAI;AACnD,YAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,OAAM,gCAAK,aAAL,mBAAe,EAAG;AACnE,cAAQ,MAAM,MAAM,MAClB,OAAO,OAAK,EAAE,YAAY,IAAI,oBAAoB,aAAa,CAAC,EAChE,QAAQ,OAAM,MAAK,MAAM,OAAO,MAAM,OAAO,GAAG,4BAA4B,EAAE,MAAM,YAAY,MAAM,EAAE,eAAe,CAAC,GAAG,4BAA4B,EAAE,MAAM,MAAM;AAAA,MAAE,CAAC,CAAC,CAAC;AAC5K,wBAAiB,SAAS,QAAQ,OAAM,MAAE;AA/B7C,YAAAA;AA+BgD,uBAAMA,MAAA,QAAQ,MAAM,SAAS,MAAM,IAAI,CAAC,MAAlC,gBAAAA,IAAqC,SAAS,MAAM,MAAM;AAAA,QAAE;AAAA,OAAE;AAEjH,YAAMC,SAAQ,MAAM,OAAO,MAAM,WAAW;AAAA,QAC3C,OAAO,EAAE,OAAO,QAAQ,MAAM,GAAG;AAAA,QACjC,QAAQ,EAAE,MAAM,KAAK;AAAA,MACtB,CAAC;AAED,YAAM,QAAO,aAAQ,UAAR,mBAAe,SAAS,MAAM,IAAIA,UAAA,gBAAAA,OAAO;AACtD,aAAM,6BAAM;AAAA,QACX,WAAW;AAAA,UACV;AAAA,UACA,SAAS,GAAG,OAAO;AAAA,UACnB,QAAQ;AAAA,QACT,CAAC;AAAA;AAAA,IAEH;AAEA,eAAW,MAAM;AAChB,wBAAiB,QAAQ;AACzB,wBAAiB,WAAW,CAAC;AAAA,IAC9B,GAAG,GAAI;AAAA,EACR;AACD;AAhDA,IAAqB,mBAArB;AAAqB,iBAGb,QAAQ;AAHK,iBAIb,WAAqB,CAAC;AAJ9B;AAAA,EAAO,oBALP;AAAA;",
  "names": ["_a", "guild"]
}

{
  "version": 3,
  "sources": ["../../commands/reports.ts"],
  "sourcesContent": ["import type { ChatInputCommandInteraction, GuildMember, TextChannel } from 'discord.js';\nimport { SlashCommandBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, EmbedBuilder, AttachmentBuilder, Colors } from 'discord.js';\nimport { addReport, defaultError, errorEmbedBuilder } from '../utils.js';\nimport prisma from '../database.js';\n\nexport default class Report {\n\tdata = new SlashCommandBuilder()\n\t\t.setName('reports')\n\t\t.setDescription('Report to spread awareness of potentially toxic users and scammers')\n\t\t.addSubcommand(subcommand =>\n\t\t\tsubcommand\n\t\t\t\t.setName('add')\n\t\t\t\t.setDescription('Add a report for a user')\n\t\t\t\t.addUserOption(option => option.setName('user').setDescription('The user you want to report').setRequired(true))\n\t\t\t\t.addStringOption(option => option.setName('reason').setDescription('Why do you want to report this user?').setRequired(true))\n\t\t\t\t.addAttachmentOption(option => option.setName('image').setDescription('To approve this report, we need image proof.').setRequired(true))\n\t\t)\n\t\t.addSubcommand(subcommand =>\n\t\t\tsubcommand\n\t\t\t\t.setName('remove')\n\t\t\t\t.setDescription('Remove a report for a user')\n\t\t\t\t.addStringOption(option => option.setName('id').setDescription('The id of the report you want taken down.').setRequired(true))\n\t\t\t\t.addStringOption(option => option.setName('reason').setDescription('Why do you want to remove this report?').setRequired(true))\n\t\t\t\t.addAttachmentOption(option => option.setName('image').setDescription('To approve this report, we need image proof.').setRequired(true))\n\t\t)\n\t\t.addSubcommand(subcommand =>\n\t\t\tsubcommand\n\t\t\t\t.setName('show')\n\t\t\t\t.setDescription('Show all reports of a user!')\n\t\t\t\t.addUserOption(option => option.setName('user').setDescription('The mention or user id of the user you want to see reports from'))\n\t\t);\n\n\tasync run(interaction: ChatInputCommandInteraction) {\n\t\tif (!interaction.inGuild()) {\n\t\t\tawait interaction.reply({ embeds: [errorEmbedBuilder('This command can only be run on a server!')] });\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (interaction.options.getSubcommand()) {\n\t\t\tcase 'add':\n\t\t\t\tawait addReport(interaction);\n\t\t\t\tbreak;\n\n\t\t\tcase 'remove':\n\t\t\t\tconst id = interaction.options.getString('id');\n\t\t\t\tconst reason = interaction.options.getString('reason');\n\t\t\t\tconst file = interaction.options.getAttachment('image');\n\n\t\t\t\tif (interaction.user.bot) {\n\t\t\t\t\tawait interaction.reply({ embeds: [errorEmbedBuilder('You cannot remove a reporting from a bot!')], ephemeral: true });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tawait interaction.deferReply({ ephemeral: true });\n\n\t\t\t\ttry {\n\t\t\t\t\tawait prisma.guild.findUnique({\n\t\t\t\t\t\twhere: { guild: interaction.guildId! },\n\t\t\t\t\t\tselect: { mods: true, admins: true, logs: true },\n\t\t\t\t\t});\n\n\t\t\t\t\tconst user = await prisma.user.findUnique({\n\t\t\t\t\t\twhere: { user: interaction.user.id },\n\t\t\t\t\t\tselect: { reports: true },\n\t\t\t\t\t});\n\n\t\t\t\t\tconst reports = user?.reports;\n\n\t\t\t\t\tif (!reports?.length) {\n\t\t\t\t\t\tawait interaction.editReply({ embeds: [errorEmbedBuilder(\"You don't have any reports\")] });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newReports = reports.filter(report => report.id !== id);\n\t\t\t\t\tif (JSON.stringify(reports) === JSON.stringify(newReports)) {\n\t\t\t\t\t\tawait interaction.editReply({ embeds: [errorEmbedBuilder(`Report with id **${id}** has not been found!`)] });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst reportSubmittedEmbed = new EmbedBuilder({\n\t\t\t\t\t\ttitle: '<:check:1008718056891101194> Report Submitted',\n\t\t\t\t\t\tdescription: `Your report was submitted and our staff team will be looking into it.\nThank you for submitting this report. For more updates please join our support server below. Please also keep your DMS on so we can easly send you feedback.`,\n\t\t\t\t\t\tcolor: Colors.Blurple,\n\t\t\t\t\t});\n\t\t\t\t\tawait interaction.editReply({ embeds: [reportSubmittedEmbed] });\n\n\t\t\t\t\tconst channel = interaction.client.channels.cache.get('1022909267440828466') as TextChannel;\n\n\t\t\t\t\tawait channel?.send({\n\t\t\t\t\t\tembeds: [\n\t\t\t\t\t\t\tnew EmbedBuilder({\n\t\t\t\t\t\t\t\tcolor: Colors.Blurple,\n\t\t\t\t\t\t\t\ttitle: '<:arrow:1009057573590290452> New Report!',\n\t\t\t\t\t\t\t\tdescription: `<:1412reply:1009087336828649533>*New report for ${interaction.user}* \\n\\n **Reason:** ${reason}`,\n\t\t\t\t\t\t\t\timage: {\n\t\t\t\t\t\t\t\t\turl: 'attachment://report.png',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tfiles: [new AttachmentBuilder(file?.url!, { name: 'report.png' })],\n\t\t\t\t\t\tcomponents: [\n\t\t\t\t\t\t\tnew ActionRowBuilder<ButtonBuilder>({\n\t\t\t\t\t\t\t\tcomponents: [\n\t\t\t\t\t\t\t\t\tnew ButtonBuilder({\n\t\t\t\t\t\t\t\t\t\tcustom_id: `unreport_approve-${id}-${interaction.user.id}`,\n\t\t\t\t\t\t\t\t\t\tlabel: 'Remove Report',\n\t\t\t\t\t\t\t\t\t\tstyle: ButtonStyle.Success,\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tnew ButtonBuilder({\n\t\t\t\t\t\t\t\t\t\tcustom_id: `report_reject`,\n\t\t\t\t\t\t\t\t\t\tlabel: 'Ignore',\n\t\t\t\t\t\t\t\t\t\tstyle: ButtonStyle.Danger,\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t} catch {\n\t\t\t\t\tawait interaction.editReply(defaultError);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'show':\n\t\t\t\tconst member = (interaction.options.getMember('user') ?? interaction.member) as GuildMember;\n\n\t\t\t\tif (member?.user.bot) {\n\t\t\t\t\tawait interaction.reply({ embeds: [errorEmbedBuilder('You cannot show reportings for a bot!')], ephemeral: true });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tawait interaction.deferReply({ ephemeral: true });\n\n\t\t\t\ttry {\n\t\t\t\t\tconst user = await prisma.user.findUnique({\n\t\t\t\t\t\twhere: { user: member?.user.id },\n\t\t\t\t\t\tselect: { reports: true },\n\t\t\t\t\t});\n\n\t\t\t\t\tconst reports = user?.reports;\n\n\t\t\t\t\tconst show = new EmbedBuilder({\n\t\t\t\t\t\tauthor: {\n\t\t\t\t\t\t\tname: interaction.guild?.name!,\n\t\t\t\t\t\t\ticon_url: interaction.guild?.iconURL()!,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttitle: '<:report:1009191992040894657> Reports',\n\t\t\t\t\t\tdescription:\n\t\t\t\t\t\t\t(reports?.length ?? 0) === 0\n\t\t\t\t\t\t\t\t? `> ${member?.user} doesn't have any reports!`\n\t\t\t\t\t\t\t\t: `> ${reports?.length === 1 ? `This is the report` : `These are the ${reports?.length ?? 0} reports`} that ${member.user} has!`,\n\t\t\t\t\t\tfields: reports?.map(report => ({\n\t\t\t\t\t\t\tname: report.id,\n\t\t\t\t\t\t\tvalue: `<:blank:1008721958210383902> <:arrow:1009057573590290452> ${report.reason}`,\n\t\t\t\t\t\t})),\n\t\t\t\t\t\tcolor: Colors.Blurple,\n\t\t\t\t\t});\n\n\t\t\t\t\tawait interaction.editReply({ embeds: [show] });\n\t\t\t\t} catch {\n\t\t\t\t\tawait interaction.editReply(defaultError);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}

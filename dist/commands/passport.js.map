{
  "version": 3,
  "sources": ["../../commands/passport.ts"],
  "sourcesContent": ["import type { ChatInputCommandInteraction } from \"discord.js\";\nimport { SlashCommandBuilder, AttachmentBuilder } from \"discord.js\";\nimport sharp from \"sharp\";\nimport {\n\tloadImage,\n\tdefaultError,\n\terrorEmbedBuilder,\n\ttimeSince,\n} from \"../utils.js\";\nimport { join } from \"node:path\";\nimport prisma from \"../database.js\";\nimport qr from \"qr-image\";\n\nexport default class Info {\n\tdata = new SlashCommandBuilder()\n\t\t.setName(\"passport\")\n\t\t.setNameLocalizations({ \"es-ES\": \"pasaporte\" })\n\t\t.setDescription(\"A card with all important info of a user.\")\n\t\t.setDescriptionLocalizations({\n\t\t\t\"es-ES\": \"Una tarjeta con toda la informacion importante de un usuario.\",\n\t\t})\n\t\t.addUserOption((option) =>\n\t\t\toption\n\t\t\t\t.setName(\"user\")\n\t\t\t\t.setNameLocalizations({ \"es-ES\": \"usuario\" })\n\t\t\t\t.setDescription(\"You can pass a mention or an id of a user.\")\n\t\t\t\t.setDescriptionLocalizations({\n\t\t\t\t\t\"es-ES\": \"Puedes pasar una menci\u00F3n o un id de un usuario\",\n\t\t\t\t}),\n\t\t);\n\n\tasync run(interaction: ChatInputCommandInteraction) {\n\t\tconst user = interaction.options.getUser(\"user\") ?? interaction.user;\n\n\t\tif (user.bot) {\n\t\t\tawait interaction.reply({\n\t\t\t\tembeds: [errorEmbedBuilder(\"You cannot get the passport of a Bot!\")],\n\t\t\t\tephemeral: true,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tawait interaction.deferReply();\n\n\t\ttry {\n\t\t\tconst avatarBuffer = await loadImage(user.displayAvatarURL());\n\t\t\tconst roundedCorners = Buffer.from(`\n\t\t\t\t<svg>\n\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"128\" height=\"128\" rx=\"50%\" ry=\"50%\"/>\n\t\t\t\t</svg>\n\t \t\t`);\n\n\t\t\tconst code = qr.imageSync(`https://discord.com/users/${user.id}`, {\n\t\t\t\ttype: \"png\",\n\t\t\t\tsize: 4,\n\t\t\t\tmargin: 2,\n\t\t\t});\n\n\t\t\tconst toxicityUser = await prisma.user.findUnique({\n\t\t\t\twhere: { user: user.id },\n\t\t\t\tselect: {\n\t\t\t\t\ttoxicity: true,\n\t\t\t\t\twarns: true,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst toxicity = toxicityUser?.toxicity?.toFixed(2);\n\t\t\tconst username = Buffer.from(`\n\t\t\t\t<svg width=\"625\" height=\"400\">\n\t\t\t\t\t<style>\n\t\t \t\t\t\t.name {\n\t\t\t\t\t\t\tfont-size: 25px;\t\t\t\t\t\t\t\n\t\t\t \t\t\t\tfont-weight: bold;\n\t\t\t \t\t\t\tfont-family: sans-serif;\n\t\t\t\t\t\t\tfill: #fff;\n\t\t\t\t\t\t}\n\n\t \t\t\t\t\t.opt {\n\t\t\t \t\t\t\tfont-size: 16px;\n\t\t\t\t\t\t\tfont-family: sans-serif;\n\t\t\t \t\t\t\tfont-weight: bold;\n\t\t\t \t\t\t\tfill: #ededed;\n\t\t\t\t\t\t}\n\t \t\t\t\t</style>\n\t\t \t \t\t<text x=\"220\" y=\"90\" class=\"name\">\n\t\t\t\t\t\t${user.username}\n\t\t \t\t\t</text>\n\t\t\t\t\t<text x=\"336\" y=\"178\" class=\"opt\">\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\t(toxicity?.endsWith(\"00\")\n\t\t\t\t\t\t\t\t? toxicity?.slice(0, -3)\n\t\t\t\t\t\t\t\t: toxicity?.endsWith(\"0\")\n\t\t\t\t\t\t\t\t? toxicity?.slice(0, -1)\n\t\t\t\t\t\t\t\t: toxicity) ?? 0\n\t\t\t\t\t\t}%\n\t\t \t\t\t</text>\n\t\t\t\t\t<text x=\"362\" y=\"156\" class=\"opt\">\n\t\t\t\t\t\t${toxicityUser?.warns?.length ?? 0}\n\t\t \t\t\t</text>\n\t\t\t\t\t<text x=\"423\" y=\"134\" class=\"opt\">${timeSince(user.createdAt)}</text>\n\t\t\t\t</svg>\n \t\t\t`);\n\n\t\t\tconst avatarRoundedBuffer = await sharp(avatarBuffer)\n\t\t\t\t.resize(128, 128)\n\t\t\t\t.composite([\n\t\t\t\t\t{\n\t\t\t\t\t\tinput: roundedCorners,\n\t\t\t\t\t\tblend: \"dest-in\",\n\t\t\t\t\t},\n\t\t\t\t])\n\t\t\t\t.png()\n\t\t\t\t.toBuffer();\n\n\t\t\tconst image = await sharp(\n\t\t\t\tjoin(\n\t\t\t\t\tprocess.cwd(),\n\t\t\t\t\tuser.id === \"713745288619360306\"\n\t\t\t\t\t\t? \"./assets/card-pinkblue.png\"\n\t\t\t\t\t\t: \"./assets/card-blue.png\",\n\t\t\t\t),\n\t\t\t)\n\t\t\t\t.composite([\n\t\t\t\t\t{\n\t\t\t\t\t\tinput: avatarRoundedBuffer,\n\t\t\t\t\t\ttop: 60,\n\t\t\t\t\t\tleft: 47,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tinput: code,\n\t\t\t\t\t\ttop: 205,\n\t\t\t\t\t\tleft: 363,\n\t\t\t\t\t},\n\t\t\t\t\t{ input: username },\n\t\t\t\t])\n\t\t\t\t.png()\n\t\t\t\t.toBuffer();\n\n\t\t\tawait interaction.editReply({\n\t\t\t\tfiles: [new AttachmentBuilder(image, { name: \"card.png\" })],\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.log(e);\n\t\t\tawait interaction.editReply(defaultError);\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
